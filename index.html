<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Textquests</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial Narrow', 'Arial Black', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: white;
        }

        .container {
            text-align: center;
            max-width: 600px;
            width: 100%;
        }

        .wheel-container {
            position: relative;
            display: inline-block;
            margin-bottom: 40px;
        }

        .wheel {
            width: 400px;
            height: 400px;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 8px solid #fff;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            transition: transform 4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            border: 1px solid rgba(255,255,255,0.3);
            clip-path: polygon(0% 100%, 100% 100%, 100% 0%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: opacity 0.2s ease;
        }

        .wheel-segment:hover {
            opacity: 0.8;
        }

        .wheel-segment.disabled {
            cursor: not-allowed;
            pointer-events: none;
        }

        .wheel-segment .segment-text {
            position: absolute;
            width: 140px;
            text-align: center;
            font-weight: 600;
            font-size: 11px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            line-height: 1.1;
            transform-origin: center;
            font-family: 'Arial Narrow', 'Helvetica Neue', Arial, sans-serif;
            letter-spacing: -0.3px;
        }

        .wheel-pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #fff;
            z-index: 10;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            z-index: 5;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        .spin-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
            border: none;
            border-radius: 50px;
            padding: 12px 16px;
            font-size: 1rem;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-weight: bold;
            color: #e8eaf6;
            text-shadow: 
                2px 2px 0px #0000008a,
                -1px -1px 0px #0000008a,
                1px -1px 0px #0000008a,
                -1px 1px 0px #0000008a,
                3px 3px 5px rgba(0,0,0,0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            width: auto;
            min-width: fit-content;
            box-sizing: border-box;
        }

        .spin-button:hover {
            background: linear-gradient(45deg, #ee5a6f, #ff6b6b);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .spin-button:active {
            transform: translateY(0);
        }

        .spin-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .result {
            margin-top: 30px;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-text {
            font-size: 1.3rem;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Mobile optimizations */
        @media (max-width: 480px) {
            .wheel {
                width: 320px;
                height: 320px;
            }

            .wheel-segment .segment-text {
                width: 110px;
                font-size: 9px;
            }

            .spin-button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .result-text {
                font-size: 1.1rem;
            }

            .container {
                padding: 10px;
            }
        }

        @media (max-width: 320px) {
            .wheel {
                width: 280px;
                height: 280px;
            }

            .wheel-segment .segment-text {
                width: 90px;
                font-size: 8px;
            }
        }

        .spinning {
            pointer-events: none;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-title {
            font-size: 2.1rem;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 
                2px 2px 0px #000,
                -1px -1px 0px #000,
                1px -1px 0px #000,
                -1px 1px 0px #000,
                3px 3px 5px rgba(0,0,0,0.5);
            color: #e8eaf6;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 8px 16px;
            background: linear-gradient(45deg, rgba(255,235,59,0.1), rgba(255,193,7,0.1));
            display: inline-block;
        }

        .page-subtitle {
            font-size: 0.8rem;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-weight: 300;
            opacity: 0.85;
            color: #e8eaf6;
            letter-spacing: 0.5px;
            font-style: normal;
        }

        @media (max-width: 480px) {
            .page-title {
                font-size: 1.8rem;
                padding: 6px 12px;
                letter-spacing: 1.5px;
            }
            
            .page-subtitle {
                font-size: 0.7rem;
                letter-spacing: 0.4px;
            }
            
            .page-header {
                margin-bottom: 30px;
            }
        }

        @media (max-width: 320px) {
            .page-title {
                font-size: 1.5rem;
                padding: 4px 8px;
                letter-spacing: 1px;
            }
            
            .page-subtitle {
                font-size: 0.6rem;
                letter-spacing: 0.3px;
            }
        }

        /* Modal styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 50px 30px 30px 30px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            text-align: center;
            animation: modalSlideIn 0.3s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.7) translateY(-50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            transition: all 0.2s ease;
            font-weight: bold;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #e8eaf6;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .quest-modal-modality {
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-size: 1rem;
            line-height: 1.3;
            opacity: 0.85;
            margin-bottom: 15px;
            padding: 0 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .quest-modal-description {
            font-size: 1.1rem;
            line-height: 1.4;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            padding: 0 10px;
            margin-bottom: 15px;
        }

        .quest-modal-extra-info, .quest-modal-bonus {
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.3;
            opacity: 0.85;
            margin-bottom: 15px;
            padding: 0 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .quest-modal-copy-quest-button {
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 5px;
            display: inline-block;
            min-width: 120px;
        }

        .quest-modal-copy-quest-button:hover {
            background: linear-gradient(45deg, #45b7d1, #4ecdc4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .quest-modal-copy-quest-button:active {
            transform: translateY(0);
        }

        .quest-modal-copy-quest-button.copied {
            background: linear-gradient(45deg, #96ceb4, #00b894);
        }

        /* Legacy support for old class names (can be removed later) */
        .modal-content {
            font-size: 1.2rem;
            line-height: 1.4;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            padding: 0 10px;
        }

        .modal-extra-info, .modal-bonus {
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.3;
            opacity: 0.85;
            margin-top: 15px;
            padding: 0 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .copy-button {
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 20px;
            display: inline-block;
            min-width: 120px;
        }

        .copy-button:hover {
            background: linear-gradient(45deg, #45b7d1, #4ecdc4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .copy-button:active {
            transform: translateY(0);
        }

        .copy-button.copied {
            background: linear-gradient(45deg, #96ceb4, #00b894);
        }

        /* Info button styles */
        .info-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }

        .info-button:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .info-button:active {
            transform: scale(0.95);
        }

        /* Info modal content styles */
        .info-modal-content {
            font-family: 'Courier New', 'Monaco', 'Lucida Console', 'Liberation Mono', monospace;
            font-size: 1rem;
            line-height: 1.4;
            opacity: 0.9;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            white-space: pre-line;
            text-align: left;
            padding: 0 10px;
        }

        /* Mobile adjustments for info button */
        @media (max-width: 480px) {
            .info-button {
                top: 15px;
                right: 15px;
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }

        @media (max-width: 320px) {
            .info-button {
                top: 10px;
                right: 10px;
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
        }

        /* Mobile modal adjustments */
        @media (max-width: 480px) {
            .modal {
                padding: 45px 20px 25px 20px;
                margin: 10px;
                border-radius: 15px;
                max-height: 70vh;
            }

            .copy-button {
                font-size: 0.8rem;
                padding: 8px 16px;
                margin-top: 15px;
                min-width: 100px;
            }

            .modal-title {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }

            .modal-content {
                font-size: 1.1rem;
                padding: 0 5px;
            }

            .modal-extra-info, .modal-bonus {
                font-size: 0.7rem;
                margin-top: 12px;
                padding: 0 5px;
            }

            .modal-close {
                top: 10px;
                right: 10px;
                width: 30px;
                height: 30px;
                font-size: 16px;
            }

            .quest-modal-description {
                font-size: 1rem;
            }

            .quest-modal-extra-info, .quest-modal-bonus {
                font-size: 0.7rem;
            }
        }

        @media (max-width: 320px) {
            .modal {
                padding: 40px 15px 20px 15px;
                margin: 5px;
            }

            .modal-title {
                font-size: 1.2rem;
            }

            .modal-content {
                font-size: 1rem;
                padding: 0 5px;
            }

            .modal-extra-info, .modal-bonus {
                font-size: 0.6rem;
                margin-top: 10px;
                padding: 0 5px;
            }

            .quest-modal-description {
                font-size: 0.95rem;
            }

            .quest-modal-extra-info, .quest-modal-bonus {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body>
    <!-- Info button -->
    <button class="info-button" id="infoButton" title="How to Play">‚ÑπÔ∏è</button>
    
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">TextQuests</h1>
            <p class="page-subtitle">A game of easy and fun things to do over text!</p>
        </div>
        <div class="wheel-container">
            <div class="wheel-pointer"></div>
            <div class="wheel" id="wheel">
                <!-- Segments will be dynamically generated -->
            </div>
            <div class="center-circle"></div>
        </div>

        <button class="spin-button" id="spinButton">Spin the Wheel!</button>
    </div>

    <!-- Modal for quest results -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <button class="modal-close" id="modalClose">&times;</button>
            <div class="modal-content" id="modalContent"></div>
        </div>
    </div>

    <script>
        const wheel = document.getElementById('wheel');
        const spinButton = document.getElementById('spinButton');
        const modalOverlay = document.getElementById('modalOverlay');
        const modalContent = document.getElementById('modalContent');
        const modalClose = document.getElementById('modalClose');
        const infoButton = document.getElementById('infoButton');
        
        // Quest dataclass structure
        class Quest {
            constructor(emoji, modality, description, extraInfo = null, bonus = null) {
                this.emoji = emoji;
                this.modality = modality;
                this.description = description;
                this.extraInfo = extraInfo;
                this.bonus = bonus;
            }
        }

        let howToPlay = 'TextQuests is played asynchronously with a partner over text.\n\n';
        howToPlay += 'Players take turns completing short, accessible challenges (quests) designed to be silly, reflective, or otherwise fun.\n\n';
        howToPlay += 'Players can EITHER spin the wheel to receive a quest OR selectively decide their quest by clicking on different wheel segments and choosing the quest they are most interested in.';

        // new Quest('üì∏', 'Share a photo of the inside your fridge‚Äîwhat is your favorite item & why?', null, 'What is your least favorite item?'),
        // new Quest('üé•', 'Share one or two memes/shorts that you find especially funny.'),
        // new Quest('üé•', 'Make a 30-sec music video using only facial muscles for dancing.', 'Play a fun song in the background and let whatever embarassing movements/expressions happen! ü§™'),
        
        const quests = [
            new Quest(
                'üó£Ô∏è', 
                'Voice Memo',
                // description
                'What is some recent positive trend in your life that you are grateful for/happy about and why?', 
                // extraInfo
                null, 
                // bonus
                'üó£Ô∏è If you were your own biggest fan/advocate, what affirmation or advice would you, in response to hearing about this, give yourself?'
            ),

            new Quest(
                'üì∏',
                'Photo',
                // description
                'Share 3-10 pics of some favorite moments from the past 2 years.', 
                // extraInfo
                null, 
                // bonus
                "üó£Ô∏è Briefly describe the what/where/when of each photo and, optionally, expound any fun/funny accompanying details/anecdotes."
            ),

            new Quest(
                'üó£Ô∏è', 
                'Voice Memo',
                // description
                'What, do you feel, is a common misperception about you?', 
                // extraInfo
                "I.e., what is one way that you are sometimes misunderstood?", 
                // bonus
                'üó£Ô∏è Elaborate for 1+ minutes. E.g.: Why do you think this is? Does it ever bother you? Do you think others interact with you differently as a result?'
            ),

            new Quest(
                'üó£Ô∏è',
                'Voice Memo', 
                // description
                'Share the story of a not-too-distant time when you laughed your rear end off (laughed unreasonably hard).', 
                // extraInfo
                null, 
                // bonus
                'üó£Ô∏è How would you describe your sense of humor? // What are the kinds of things that get you laughing the hardest?'
            ),

            new Quest(
                'üó£Ô∏è',
                'Voice Memo',
                // description
                'What, do you feel, is a side of you that the world doesn\'t often get to see?', 
                // extraInfo
                'How does it differ from the side(s) that the world does typically see?', 
                // bonus
                'üó£Ô∏è Elaborate for 1+ minutes.'
            ),

            new Quest(
                'üì∏',
                'Photo', 
                // description
                'Share a pic+explanation of your favorite part of/thing in your house.', 
                // extraInfo
                null, 
                // bonus
                'üó£Ô∏è Describe your dream house/property. Wide-open spaces? Plants? Convenience? In a world w/ no global warming or humanitarian issues, what is the first outlandish luxury purchase that you would totally want?'
            ),

            new Quest(
                'üó£Ô∏è', 
                'Voice Memo',
                // description
                'What are some themes for how you feel connection with/loved by other humans?',
                // extraInfo
                'Think about times you have felt seen by, appreciated by, or otherwise connected to friends/others. What were they saying, sharing, or doing that induced this sensation?',
                // bonus
                'üó£Ô∏è Conversely, when you feel affinity/connectedness/etc. towards someone, how does this tend to come out of (or stay in) you? E.g.:\n\n'+
                '1Ô∏è‚É£ Hugs, etc. (physical touch gestures)\n2Ô∏è‚É£ Explicitly expressed affirmations\n3Ô∏è‚É£ General warmth/friendliness/smiling w/out explicitly expressed affirmations\n'+
                '4Ô∏è‚É£ Playfulness in the form of teasing/sarcasm (gentle or even cruel)\n5Ô∏è‚É£ Inclination for symbolic tokens of appreciation (service, gifting, etc.)\n'+
                '6Ô∏è‚É£ Plain ol\' wanting to share time with/hang around someone‚Äîeven if in silence'
            ),

            new Quest(
                'üì∏',
                'Photo',
                // description
                'Share a random, out-of-pocket, or embarassing thing from ur camera roll and never talk about it again.',
                // extraInfo
                'Your game partner will live in confusion for the rest of their life... muahahaha üòà',
                // bonus
                null
            ),

            new Quest(
                'üé∑',
                'Music/Playlist',
                // description
                'Make/share a 5+ song playlist titled "[your name]-core."', 
                // extraInfo
                'üó£Ô∏è E.g., if your name is Marge, you would make a playlist titled "Marge-core", with 5+ songs that capture your vibe/aesthetic.'
            ),

            new Quest(
                'üó£Ô∏è',
                'Voice Memo',
                // description
                'Share one or more quirks about how, where, or with whom you grew up.', 
                // extraInfo
                null, 
                // bonus
                "üó£Ô∏è Elaborate for 1+ minutes and describe both something positive as well as something negative. How have these things shaped you/your life today?"
            ),

            new Quest(
                'üé•',
                'Video',
                // description
                'Share one (or, at max, 2-3) video(s) that bring you joy (YouTube, camera roll, TikTok, etc.).', 
                // extraInfo
                null,
                // bonus
                'üó£Ô∏è Explain any background/context as needed. // What is it about the video(s) that is so joy-sparking/special to you?'
            ),

            new Quest(
                'üì∏', 
                'Photo',
                // description
                'With ur game partner, see who can take the silliest photo in the next 48 hours.', 
                // extraInfo
                'ü§ù Although your partner is required to participate, this still only counts as your turn. After this quest, your partner will take their next turn as normal.',
                // bonus
                'üßë‚Äç‚öñÔ∏è Get a 3rd-party judge involved; the winner gets to give the loser a (kind/reasonable) dare.'
            ),

            new Quest(
                'üó£Ô∏è',
                'Voice Memo',
                // description
                'Perform a haiku about something that frustrated you today.', 
                // extraInfo
                'The goofier the haiku/voice used, the better!', 
                // bonus
                'üó£Ô∏è Add any prelude/post-commentary as needed. // In general, how do you naturally react to or express frustration (e.g., stuffing it down/disassociating, finding someone to vent to, escaping to a comfort place/behavior/food, etc)? How do you wish you reacted instead?'
            ),

            new Quest(
                'üì∏',
                'Photo',
                // description
                'Share 1-3 fictional (cartoon, movie, etc.) characters that your game partners reminds you of.', 
                // extraInfo
                null, 
                // bonus
                'üó£Ô∏è Justify you choice(s). What is it about each character that they embody?'
            ),

            new Quest(
                'üó£Ô∏è',
                'Voice Memo',
                // description
                'Share with your game partner 1-3 things you admire or like about them.',
                // extraInfo
                'I mean, they must be pretty stinkin\' cool if they\'re playing TextQuests with you!', 
                // bonus
                null
            ),

            // new Quest(
            //     'üó£Ô∏è',
            //     'Voice Memo',
            //     // description
            //     'Besides you, who is the goofiest member of your family (or some other core social group)? In what way(s) are they goofy?', 
            //     // extraInfo
            //     null, 
            //     // bonus
            //     'üó£Ô∏è What is a fun memory that exemplifies this goofiness? How does this compare/contrast to your flavor of goofiness?'
            // ),

            new Quest(
                'üé∑',
                'Music/Playlist',
                // description
                'What are some songs (make a playlist?) that your peers often seem to love, but you just kind of don\'t get?', 
                // extraInfo
                null, 
                // bonus
                'üó£Ô∏è Conversely, what is a "hot take" song (i.e., weird, controversial, or otherwise not-so-mass-appealing song) that, for some reason, you totally dig?'
            ),

            new Quest(
                'üé∑',
                'Music/Playlist',
                // description
                'Make/share a 3+ song playlist titled "[your game partner\'s name]-core."', 
                // extraInfo
                'E.g., if your partner\'s name is Sam, you would make a playlist titled "Sam-core", with 3+ songs that you think capture their vibe/aesthetic.',
                // bonus
                null
            ),

            new Quest(
                'üì∏',
                'Photo',
                // description
                'Share 1+ pic(s) of yourself in some form of costume or goofy apparel.', 
                // extraInfo
                'E.g., an old Halloween costume, funny sunglasses at the store, etc.', 
                // bonus
                'üìÖ Make this be a photo that you take in the next 24 hours.'
            ),
        ];
        
        // Colors for the segments (will cycle if more segments than colors)
        const colors = [
            '#ff7675',
            '#feca57',
            '#7f4de3',
            '#54a0ff',
            '#a29bfe',
            '#fd79a8',
            '#ff6b6b',
            '#4ecdc4',
            '#45b7d1',
            '#ff9ff3',
            '#fdcb6e',
            '#74b9ff',
            '#96ceb4',
            '#4369b5',
            '#e17055',
            '#00b894',
            '#00cec9',
            '#eda6d3',
        ];
        
        let isSpinning = false;
        let currentRotation = 0;

        // Initialize the wheel
        function createWheel() {
            const numSegments = quests.length;
            const anglePerSegment = 360 / numSegments;
            
            wheel.innerHTML = ''; // Clear existing segments
            
            for (let i = 0; i < numSegments; i++) {
                const segment = document.createElement('div');
                segment.className = 'wheel-segment';
                
                const angle = i * anglePerSegment;
                const colorIndex = i % colors.length;
                
                // Create proper pie slice using clip-path
                const startAngle = (i * anglePerSegment) - 90; // Start from top
                const endAngle = ((i + 1) * anglePerSegment) - 90;
                
                // Convert angles to radians for calculations
                const startRad = (startAngle * Math.PI) / 180;
                const endRad = (endAngle * Math.PI) / 180;
                
                // Calculate multiple points along the arc for a proper pie slice
                const centerX = 50;
                const centerY = 50;
                const radius = 50;
                
                // Create points for the pie slice - start from center, go to start edge, along arc, back to center
                let clipPathPoints = `50% 50%`; // Start at center
                
                // Add start point
                const x1 = centerX + radius * Math.cos(startRad);
                const y1 = centerY + radius * Math.sin(startRad);
                clipPathPoints += `, ${x1}% ${y1}%`;
                
                // Add points along the arc (more points for smoother curves on wider segments)
                const arcPoints = Math.max(2, Math.ceil(anglePerSegment / 5)); // More points for larger segments
                for (let j = 1; j < arcPoints; j++) {
                    const intermediateAngle = startAngle + (anglePerSegment * j / arcPoints);
                    const intermediateRad = (intermediateAngle * Math.PI) / 180;
                    const xIntermediate = centerX + radius * Math.cos(intermediateRad);
                    const yIntermediate = centerY + radius * Math.sin(intermediateRad);
                    clipPathPoints += `, ${xIntermediate}% ${yIntermediate}%`;
                }
                
                // Add end point
                const x2 = centerX + radius * Math.cos(endRad);
                const y2 = centerY + radius * Math.sin(endRad);
                clipPathPoints += `, ${x2}% ${y2}%`;
                
                // Create proper pie slice
                segment.style.background = colors[colorIndex];
                segment.style.clipPath = `polygon(${clipPathPoints})`;
                segment.style.transform = 'none';
                segment.style.width = '100%';
                segment.style.height = '100%';
                segment.style.position = 'absolute';
                segment.style.border = '1px solid rgba(255,255,255,0.3)';
                
                // Add data attribute for easier identification
                segment.setAttribute('data-quest-index', i);
                
                // Create text element
                const textElement = document.createElement('div');
                textElement.className = 'segment-text';
                textElement.textContent = quests[i].description;
                
                // Position text in the middle of the segment
                const midAngle = startAngle + (anglePerSegment / 2);
                const textDistance = 32; // Distance from center (adjusted for larger wheel)
                const textX = 50 + textDistance * Math.cos((midAngle * Math.PI) / 180);
                const textY = 50 + textDistance * Math.sin((midAngle * Math.PI) / 180);
                
                textElement.style.left = `${textX}%`;
                textElement.style.top = `${textY}%`;
                // Rotate text to read left-to-right from center toward edge (no +90 offset)
                textElement.style.transform = `translate(-50%, -50%) rotate(${midAngle}deg)`;
                
                // Dynamic font sizing based on text length and number of segments
                const textLength = quests[i].description.length;
                const baseFontSize = Math.max(8, 27 - numSegments); // Base size decreases with more segments
                const lengthPenalty = Math.max(0, textLength - 30) * 0.1; // Reduce size for long text
                const dynamicFontSize = Math.max(6, baseFontSize - lengthPenalty);
                
                textElement.style.fontSize = dynamicFontSize + 'px';
                textElement.style.width = '100px'; // Fixed width for text wrapping
                textElement.style.whiteSpace = 'normal'; // Allow text wrapping
                textElement.style.overflow = 'hidden';
                textElement.style.wordBreak = 'break-word';
                
                segment.appendChild(textElement);
                wheel.appendChild(segment);
            }
            
            // Reinitialize click listeners after creating segments
            addSegmentClickListeners();
        }

        // Initialize wheel on page load
        createWheel();
        
        // Add click functionality to wheel segments
        function addSegmentClickListeners() {
            const segments = document.querySelectorAll('.wheel-segment');
            segments.forEach((segment, index) => {
                segment.addEventListener('click', (e) => {
                    if (isSpinning) return; // Don't allow clicks while spinning
                    e.stopPropagation();
                    showResultModal(quests[index]);
                });
                
                // Add touch support for mobile
                segment.addEventListener('touchend', (e) => {
                    if (isSpinning) return;
                    e.preventDefault();
                    e.stopPropagation();
                    showResultModal(quests[index]);
                });
            });
        }
        
        // Match button width to title width for symmetry
        function matchButtonWidth() {
            const title = document.querySelector('.page-title');
            const button = document.querySelector('.spin-button');
            if (title && button) {
                const titleWidth = title.offsetWidth;
                button.style.width = titleWidth + 'px';
            }
        }
        
        // Set width on load and resize
        window.addEventListener('load', matchButtonWidth);
        window.addEventListener('resize', matchButtonWidth);

        spinButton.addEventListener('click', spinWheel);

        function spinWheel() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            spinButton.textContent = 'Spinning...';
            
            // Disable segment clicks while spinning
            const segments = document.querySelectorAll('.wheel-segment');
            segments.forEach(segment => segment.classList.add('disabled'));
            
            // Generate random spin (3-6 full rotations + random angle)
            const minSpins = 2;
            const maxSpins = 5;
            const spins = Math.random() * (maxSpins - minSpins) + minSpins;
            const finalAngle = Math.random() * 360;
            const totalRotation = (spins * 360) + finalAngle;
            
            currentRotation += totalRotation;
            
            // Apply the rotation
            wheel.style.transform = `rotate(${currentRotation}deg)`;
            
            // Calculate result after spin completes
            setTimeout(() => {
                const normalizedAngle = (360 - (currentRotation % 360)) % 360;
                const segmentAngle = 360 / quests.length;
                const segmentIndex = Math.floor(normalizedAngle / segmentAngle);
                const selectedQuest = quests[segmentIndex];
                
                // Show result in modal
                showResultModal(selectedQuest);
                
                // Reset button state
                spinButton.disabled = false;
                spinButton.textContent = 'Spin the Wheel!';
                isSpinning = false;
                
                // Re-enable segment clicks
                segments.forEach(segment => segment.classList.remove('disabled'));
                
                // Add a little celebration effect
                confetti();
            }, 4000);
        }

        function confetti() {
            // Simple confetti effect using emojis
            const emojis = ['üéâ', 'üéä', '‚ú®', 'üåü', 'üí´'];
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    createConfettiPiece(emojis[Math.floor(Math.random() * emojis.length)]);
                }, i * 100);
            }
        }

        function createConfettiPiece(emoji) {
            const confettiPiece = document.createElement('div');
            confettiPiece.textContent = emoji;
            confettiPiece.style.position = 'fixed';
            confettiPiece.style.left = Math.random() * window.innerWidth + 'px';
            confettiPiece.style.top = '-50px';
            confettiPiece.style.fontSize = '24px';
            confettiPiece.style.pointerEvents = 'none';
            confettiPiece.style.zIndex = '1000';
            confettiPiece.style.transition = 'all 3s ease-out';
            
            document.body.appendChild(confettiPiece);
            
            // Animate the confetti falling
            setTimeout(() => {
                confettiPiece.style.top = window.innerHeight + 'px';
                confettiPiece.style.transform = 'rotate(720deg)';
                confettiPiece.style.opacity = '0';
            }, 100);
            
            // Remove the element after animation
            setTimeout(() => {
                document.body.removeChild(confettiPiece);
            }, 3000);
        }

        // Modal functions
        function showResultModal(quest) {
            let modalHTML = `<div class="quest-modal-modality">${quest.emoji} [${quest.modality}]</div>`;
            modalHTML += `<div class="quest-modal-description">${quest.description.replace(/\n/g, '<br>')}</div>`;
            if (quest.extraInfo) {
                modalHTML += `<div class="quest-modal-extra-info">‚ÑπÔ∏è ${quest.extraInfo.replace(/\n/g, '<br>')}</div>`;
            } 
            if (quest.bonus) {
                modalHTML += `<div class="quest-modal-bonus">BONUS: ${quest.bonus.replace(/\n/g, '<br>')}</div>`;
            }
            const escapedDescription = quest.description.replace(/`/g, '\\`').replace(/'/g, "\\'");
            const escapedExtraInfo = quest.extraInfo ? quest.extraInfo.replace(/`/g, '\\`').replace(/'/g, "\\'") : null;
            const escapedBonus = quest.bonus ? quest.bonus.replace(/`/g, '\\`').replace(/'/g, "\\'") : null;
            modalHTML += `<button class="quest-modal-copy-quest-button" onclick="copyQuestText('${quest.emoji}', \`${quest.modality}\`, \`${escapedDescription}\`, ${escapedExtraInfo ? `\`${escapedExtraInfo}\`` : 'null'}, ${escapedBonus ? `\`${escapedBonus}\`` : 'null'})">Copy Prompt</button>`;
            modalContent.innerHTML = modalHTML;
            modalOverlay.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function hideModal() {
            modalOverlay.classList.remove('show');
            document.body.style.overflow = ''; // Restore scrolling
        }

        function showInfoModal() {
            const modalHTML = `
                <div class="info-modal-content">${howToPlay}</div>
            `;
            modalContent.innerHTML = modalHTML;
            modalOverlay.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function copyQuestText(emoji, modality, description, extraInfo, bonus) {
            let formattedText = `My prompt was:\n\n${emoji} [${modality}]\n\n${description}`;
            
            if (extraInfo) {
                formattedText += `\n\n‚ÑπÔ∏è ${extraInfo}`;
            }
            
            if (bonus) {
                formattedText += `\n\nBONUS: ${bonus}`;
            }
            
            // Use the modern clipboard API if available
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(formattedText).then(() => {
                    showCopyFeedback();
                }).catch((err) => {
                    console.error('Failed to copy text: ', err);
                    fallbackCopyText(formattedText);
                });
            } else {
                // Fallback for older browsers or non-secure contexts
                fallbackCopyText(formattedText);
            }
        }

        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopyFeedback();
            } catch (err) {
                console.error('Fallback copy failed: ', err);
                alert('Copy failed. Please manually select and copy the text.');
            }
            
            document.body.removeChild(textArea);
        }

        function showCopyFeedback() {
            const copyButton = document.querySelector('.quest-modal-copy-quest-button');
            if (copyButton) {
                const originalText = copyButton.textContent;
                copyButton.textContent = 'Copied!';
                copyButton.classList.add('copied');
                
                setTimeout(() => {
                    copyButton.textContent = originalText;
                    copyButton.classList.remove('copied');
                }, 2000);
            }
        }

        // Modal event listeners
        modalClose.addEventListener('click', hideModal);
        modalOverlay.addEventListener('click', function(e) {
            if (e.target === modalOverlay) {
                hideModal();
            }
        });

        // Info button event listener
        infoButton.addEventListener('click', showInfoModal);

        // Escape key to close modal
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modalOverlay.classList.contains('show')) {
                hideModal();
            }
        });

        // Touch feedback for mobile
        spinButton.addEventListener('touchstart', function() {
            this.style.transform = 'scale(0.95)';
        });

        spinButton.addEventListener('touchend', function() {
            if (!this.disabled) {
                this.style.transform = 'scale(1)';
            }
        });
    </script>
</body>
</html>
